(this["webpackJsonpsubtitle-concatenator"]=this["webpackJsonpsubtitle-concatenator"]||[]).push([[0],{22:function(e,t,n){},32:function(e,t,n){"use strict";n.r(t);var r,o,c=n(0),a=n.n(c),u=n(13),i=n.n(u),s=(n(22),n(2)),l=n.n(s),f=n(1),d=n(5),p=n(4),v=n(17),m=n(14),h=function(e){return e[e.length-1]},j=/(<[^>]+>)/g,b=function(e){return e.replace(j,"")},w=function(e){return function(t){return function(e){return b(e)===b(e).toUpperCase()}(t)?function(e){return function(t){var n=-1;return t.split(j).map((function(t,r){return r%2?t:t.replace(/\w+/g,(function(t){return++n,e.find((function(e){return e.toLowerCase()===t.toLowerCase()}))||(0===n?function(e){return e.slice(0,1).toUpperCase()+e.slice(1)}(t.toLowerCase()):t.toLowerCase())}))})).join("")}}(e)(t):t}},x=function(e){var t=e.customWords;return function(e){return e.reduce((function(e,t){var n=Object(p.a)(t,3),r=n[0],o=n[1],c=n[2];return e.length&&!/[.?!]$/.test(b(h(h(e).chunks)))||e.push({ts:[],chunks:[]}),h(e).ts.push(r),h(e).ts.push(o),h(e).chunks.push(c),e}),[]).map((function(e){var n=e.ts,r=e.chunks;return{ts:[n[0],h(n)],sentence:r.join(" ").split(".").map(w(t)).join(".")}}))}},O=function(e){return function(t){var n=t.split(":").reverse(),r=Object(m.a)(n),o=r[0],c=r.slice(1),a=String(function(e){return function(t){return(n=0,r=999,function(e){return[n,r,e].sort((function(e,t){return t-e}))[1]})(Math.round(t/e*1e3));var n,r}}(e)(Number(o))).padStart(3,"0");return[c.reverse().join(":"),a].join(".")}},g=function(e){return"- ".concat(e)},S=function(e){return e.reduce((function(e,t){var n=t.ts,r=t.sentence,o=[n.map(O(30)).join(" --\x3e "),g(r)].join("\n");return[].concat(Object(f.a)(e),[o])}),["WEBVTT"]).join("\n\n")},k=n(15),C=n.n(k),E=n(16),y=n.n(E),T=n(3),W=function(e){return new Promise((function(t){var n=new FileReader;n.onload=function(e){return t(e.target.result)},n.readAsArrayBuffer(e)}))},L=function(e,t,n){var r=new Blob([t],{type:n}),o=document.createElement("a");o.href=window.URL.createObjectURL(r);var c=e;o.download=c,o.click()},R=null!==(r=JSON.parse(null!==(o=localStorage.getItem("form"))&&void 0!==o?o:"null"))&&void 0!==r?r:{customWords:"LED,V,AC,DC,DP,CP,ISO,E,I,R"};delete R.file;var I=function(){var e,t,n=Object(v.a)({defaultValues:R}),r=n.register,o=n.watch,a=n.handleSubmit,u=Object(c.useMemo)((function(){var e;return null!==(e=o("file"))&&void 0!==e?e:[]}),[o]),i=Object(c.useRef)((null!==(e=null===(t=o("customWords"))||void 0===t?void 0:t.split(","))&&void 0!==e?e:[]).map((function(e){return e.trim()})));Object(c.useEffect)((function(){var e,t;i.current=null!==(e=null===(t=o("customWords"))||void 0===t?void 0:t.split(","))&&void 0!==e?e:[]}),[o]);var s=Object(c.useState)(null),m=Object(p.a)(s,2),h=(m[0],m[1]);return Object(c.useEffect)((function(){u.length&&Object(d.a)(l.a.mark((function e(){var t,n,r,o,c,a,s,d,v,m;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u[0],e.next=3,W(t);case 3:return n=e.sent,r=new C.a.Workbook,e.next=7,r.xlsx.load(n);case 7:return o=[],r.eachSheet((function(e,t){var n=[];o[t]=n,e.eachRow((function(e,t){if(1!==t){var r=[];n.push(r),e.eachCell((function(e){r.push(String(e.value))}))}}))})),c=Object(f.a)(o.entries()).reduce((function(e,t){var n=Object(p.a)(t,2),r=n[0],o=n[1];return o?(e[r]=x({customWords:i.current})(o),e):e}),[]),r.eachSheet((function(e,t){e.properties.defaultRowHeight=0,e.columns.forEach((function(e,t){[0,1].includes(t)&&(e.width=12)})),e.eachRow((function(e,n){1!==n&&e.eachCell((function(e,r){var o,a,u=null!==(o=null===(a=c[t])||void 0===a?void 0:a[n-2])&&void 0!==o?o:{},i=u.ts,s=u.sentence;switch(r){case 1:e.alignment={vertical:"top",horizontal:"left",wrapText:!0},e.value=null===i||void 0===i?void 0:i[0];break;case 2:e.alignment={vertical:"top",horizontal:"left",wrapText:!0},e.value=null===i||void 0===i?void 0:i[1];break;case 3:e.alignment={vertical:"top",horizontal:"left",wrapText:!0},e.value=s;break;default:e.value=void 0}}))}))})),h(r),e.next=14,r.xlsx.writeBuffer();case 14:return a=e.sent,s=[],d="".concat(t.name.split(".").slice(0,-1).join("."),"_concat"),s.push({filename:"".concat(d,".xlsx"),content:a,mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),c.map(S).forEach((function(e,t){s.push({filename:"".concat(r.worksheets.find((function(e){return e.id===t})).name,".vtt"),content:(new TextEncoder).encode(e),mimeType:"text/plain"})})),v=new y.a,s.forEach((function(e){var t=e.filename,n=e.content;e.mimeType;v.file(t,n,{})})),e.next=23,v.generateAsync({type:"blob"});case 23:m=e.sent,L("".concat(d,"_").concat((new Date).toISOString(),".zip"),m,"application/zip");case 25:case"end":return e.stop()}}),e)})))()}),[u]),Object(T.jsxs)("form",{onChange:a((function(e){delete e.file,localStorage.setItem("form",JSON.stringify(e))})),children:[Object(T.jsx)("br",{}),Object(T.jsxs)("label",{children:["Upload file (XLSX)",Object(T.jsx)("input",{type:"file",name:"file",ref:r})]}),Object(T.jsx)("br",{}),Object(T.jsx)("br",{}),Object(T.jsxs)("label",{children:["Words not to lower-case (comma separated, case sensitive for output)",Object(T.jsx)("textarea",{name:"customWords",ref:r})]})]})};i.a.render(Object(T.jsx)(a.a.StrictMode,{children:Object(T.jsx)(I,{})}),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.babe92c0.chunk.js.map